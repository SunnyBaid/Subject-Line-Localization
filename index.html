<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Subject Line Localization Table</title>
  <style>
    body { font-family:'Segoe UI',Arial,sans-serif; margin:0; transition:background .4s ease,color .4s ease; }
    header { padding:24px; border-bottom:1px solid #ccc; }
    h1 { margin:0 0 8px; font-size:20px; }
    main { max-width:1000px; margin:32px auto; padding:0 24px; }
    .controls { margin-bottom:16px; display:flex; flex-wrap:wrap; gap:12px; align-items:center; }
    .lang-label { font-weight:bold; margin-top:12px; }

    table { width:100%; border-collapse:collapse; margin-top:12px; }
    th,td { border:1px solid #ddd; padding:8px; text-align:left; }
    th { font-weight:600; }
    tr:nth-child(even) { background:#fafafa; }

    .toggle-btn,.theme-btn,.custom-select__button {
      padding:8px 12px; font-size:14px; border:2px solid var(--cs-border,#000);
      border-radius:6px; background:var(--cs-bg,#fff); color:var(--cs-fg,#000); cursor:pointer;
    }
    .copy-btn { padding:6px 10px; font-size:12px; border:1.5px solid var(--cs-border,#000); border-radius:6px; background:var(--cs-bg,#fff); color:var(--cs-fg,#000); cursor:pointer; }
    .copy-btn:disabled { opacity:.6; cursor:not-allowed; }

    .custom-select { position:relative; display:inline-block; }
    .custom-select__button { min-width:220px; text-align:left; }
    .custom-select__button::after { content:""; float:right; margin-top:6px; border:6px solid transparent; border-top-color:currentColor; }
    .custom-select__list { position:absolute; z-index:10; top:calc(100% + 6px); left:0; right:0; max-height:240px; overflow:auto; list-style:none; margin:0; padding:6px; border:2px solid var(--cs-border,#000); border-radius:8px; background:var(--cs-bg,#fff); box-shadow:0 6px 14px rgba(0,0,0,.18); display:none; }
    .custom-select__list[aria-hidden="false"] { display:block; }
    .custom-select__list li { padding:8px 10px; border-radius:6px; font-size:14px; cursor:pointer; }
    .custom-select__list li:hover, .custom-select__list li[aria-selected="true"], .custom-select__list li:focus { background:rgba(0,120,212,.12); outline:none; }

    body.light { --cs-bg:#fff; --cs-fg:#000; --cs-border:#000; background:#fff; color:#000; }
    body.dark  { --cs-bg:#2c2c2c; --cs-fg:#fff; --cs-border:#bbb; background:#121212; color:#f5f5f5; }
    body.blue  { --cs-bg:#fff; --cs-fg:#003366; --cs-border:#003366; background:#e6f0ff; color:#003366; }

    /* Description column toggle */
    #subjectTable.desc-hidden th:nth-child(3), #subjectTable.desc-hidden td:nth-child(3) { display:none; }
    #descHeader, .descCol { width:320px; }

    /* MVTD panel */
    .mvtd-panel { margin-top:12px; padding:12px 14px; border:2px solid var(--cs-border,#000); border-radius:8px; background:var(--cs-bg,#fff); color:var(--cs-fg,#000); }
    .mvtd-row { display:grid; grid-template-columns:1fr; gap:8px; }
    .mvtd-row label { font-weight:600; }
    .mvtd-input { width:100%; padding:8px; border:2px solid var(--cs-border,#000); border-radius:6px; background:var(--cs-bg,#fff); color:var(--cs-fg,#000); }
    .mvtd-result { margin-top:12px; }
    .mvtd-actions { display:flex; gap:8px; margin-top:8px; }

    .toast { position:fixed; bottom:16px; left:50%; transform:translateX(-50%); background:#000; color:#fff; padding:8px 12px; border-radius:4px; font-size:12px; opacity:0; pointer-events:none; transition:opacity .2s; }
    .toast.show { opacity:.9; }
  </style>
</head>

<body class="light">
  <header>
    <h1>Subject Line Localization Table</h1>
    <div>Choose language and theme below.</div>
  </header>

  <main>
    <div class="controls">
      <label for="langButton">Language:</label>
      <div class="custom-select" id="langSelectRoot">
        <button id="langButton" type="button" class="custom-select__button" aria-haspopup="listbox" aria-expanded="false">EN</button>
        <ul id="langList" class="custom-select__list" role="listbox" aria-hidden="true"></ul>
      </div>

      <button id="onDemandBtn" type="button" class="toggle-btn" aria-pressed="false">Include On‑Demand</button>
      <button id="themeBtn" type="button" class="theme-btn">Theme: Light</button>
      <button id="descToggleBtn" type="button" class="toggle-btn" aria-pressed="true">Show Description (ON)</button>
    </div>

    <div class="lang-label" id="langLabel"></div>

    <table id="subjectTable" aria-live="polite">
      <thead>
        <tr>
          <th id="snHeader">#</th>
          <th id="enHeader">Subject in EMC</th>
          <th id="descHeader">Description in EMC</th>
          <th>Localized Subject Line</th>
          <th>Copy</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <section class="note" aria-label="Legend and upcoming items">
      <div class="note__title">Note</div>
      <ul class="note__list">
        <li><strong>WD</strong> – Waitlist Denied</li>
        <li><strong>RD</strong> – Registration Denied</li>
      </ul>
    </section>

    <!-- MVTD (separate module) -->
    <section aria-label="MVTD Lookup" style="margin-top:24px;">
      <button id="mvtdBtn" type="button" class="toggle-btn" aria-expanded="false">MVTD Lookup</button>

      <div id="mvtdForm" class="mvtd-panel" style="display:none;" aria-hidden="true">
        <div class="mvtd-row">
          <label for="mvtdEvent">Event Sub Type</label>
          <select id="mvtdEvent" class="mvtd-input" aria-describedby="mvtdEventHint"></select>
          <small id="mvtdEventHint">Headings separate FY25 and FY26 (FY26 supports English primary language only).</small>

          <label for="mvtdLang">Language</label>
          <select id="mvtdLang" class="mvtd-input"></select>

          <label for="mvtdDay">Day Format</label>
          <select id="mvtdDay" class="mvtd-input"></select>
        </div>

        <div class="mvtd-actions">
          <button id="mvtdSubmit" type="button" class="toggle-btn">Get Subject Line</button>
          <button id="mvtdReset" type="button" class="toggle-btn">Reset</button>
        </div>

        <div id="mvtdResult" class="mvtd-result note" role="status" aria-live="polite" style="display:none;">
          <div><strong>Scope:</strong> <span id="mvtdScopeOut"></span></div>
          <div><strong>Launch Date:</strong> <span id="mvtdLaunchOut"></span></div>
          <div><strong>Subject Line:</strong> <span id="mvtdSubjectOut"></span></div>
          <div><strong>Friendly Name:</strong> <span id="mvtdFriendlyOut"></span></div>
          <div class="mvtd-actions">
            <button id="mvtdCopySubject" type="button" class="copy-btn">Copy Subject</button>
            <button id="mvtdCopyFriendly" type="button" class="copy-btn">Copy Friendly Name</button>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- FIXED: closed properly -->
  <div id="toast" class="toast" role="status" aria-live="polite"></div>

  <script>
    /* ===== Localization (unchanged) ===== */
    const DATA = {
      "EN": {
        "Registration confirmation": "Microsoft Event Registration Confirmation",
        "Waitlist confirmation / Registration Pending": "Microsoft Event Registration Pending",
        "Waitlist denied / Registration denied": "Microsoft Event Registration Status Update WD",
        "Event update reschedule": "Microsoft Event Change Notice to Registered Customers",
        "Event Cancellation": "Microsoft Event Cancellation Notice to Registered Customers",
        "Event reminder": "Microsoft Event Reminder (T1, T3)",
        "Thank you for attending": "Thank You For Attending",
        "Sorry we missed you": "We’re Sorry We Missed You",
        "Apology Pre-resolution/Event Agenda Update Email": "Sorry, we experienced an issue with your event",
        "Microsoft Event On-Demand Registration Confirmation": "Microsoft Event On-Demand Registration Confirmation"
      },
      "EN-US": {
        "Registration confirmation": "Microsoft Event Registration Confirmation",
        "Waitlist confirmation / Registration Pending": "Microsoft Event Registration Pending",
        "Waitlist denied / Registration denied": "Microsoft Event Registration Status Update",
        "Event update reschedule": "Microsoft Event Change Notice to Registered Customers",
        "Event Cancellation": "Microsoft Event Cancellation Notice to Registered Customers",
        "Event reminder": "Microsoft Event Reminder",
        "Thank you for attending": "Thank You For Attending",
        "Sorry we missed you": "We’re Sorry We Missed You",
        "Apology Pre-resolution/Event Agenda Update Email": "Sorry, we experienced an issue with your event",
        "Microsoft Event On-Demand Registration Confirmation": "Microsoft Event On-Demand Registration Confirmation"
          },
      "AR-SA": {
        "Registration confirmation": "تأكيد تسـجيل الأحداث من Microsoft",
        "Waitlist confirmation / Registration Pending": "تسـجيل الأحداث من Microsoft معلّق",
        "Waitlist denied / Registration denied": "تحديث حالة تسـجيل الأحداث من Microsoft",
        "Event update reschedule": "إشعار تغيير الأحداث من Microsoft للعملاء المسـجّلين",
        "Event Cancellation": "إشعار إلغاء حدث Microsoft للعملاء المسـجّلين",
        "Event reminder": "التذكير بأحداث Microsoft",
        "Thank you for attending": "أشكر لكم حضوركم",
        "Sorry we missed you": "نأسف على عدم حضورك",
        "Apology Pre-resolution/Event Agenda Update Email": "عذرًا، واجهنا مشكلة في الحدث الخاص بك",
        "Microsoft Event On-Demand Registration Confirmation": "تأكيد تسجيل الأحداث حسب الطلب من Microsoft"
      },
      "CS-CZ": {
        "Registration confirmation": "Potvrzení registrace na akci společnosti Microsoft",
        "Waitlist confirmation / Registration Pending": "Probíhá registrace na akci společnosti Microsoft",
        "Waitlist denied / Registration denied": "Aktualizace stavu registrace na akci společnosti Microsoft",
        "Event update reschedule": "Oznámení o změně akce společnosti Microsoft pro registrované zákazníky",
        "Event Cancellation": "Oznámení o zrušení akce společnosti Microsoft pro registrované zákazníky",
        "Event reminder": "Připomenutí akce společnosti Microsoft",
        "Thank you for attending": "Děkujeme za vaši účast",
        "Sorry we missed you": "Je nám líto, že vám to nevyšlo",
        "Apology Pre-resolution/Event Agenda Update Email": "Je nám líto, ale došlo k problému s vaší akcí",
        "Microsoft Event On-Demand Registration Confirmation": "Potvrzení registrace na akci Microsoftu na vyžádání"
      },
      "DA-DK": {
        "Registration confirmation": "Bekræftelse af tilmelding til Microsoft-begivenhed",
        "Waitlist confirmation / Registration Pending": "Afventer bekræftelse af tilmelding til Microsoft-begivenhed",
        "Waitlist denied / Registration denied": "Statusopdatering for tilmelding til Microsoft-begivenhed",
        "Event update reschedule": "Meddelelse til tilmeldte kunder om ændring af Microsoft-begivenhed",
        "Event Cancellation": "Meddelelse til tilmeldte kunder om annullering af Microsoft-begivenhed",
        "Event reminder": "Påmindelse om Microsoft-begivenhed",
        "Thank you for attending": "Tak, fordi du var med",
        "Sorry we missed you": "Vi er kede af, at du ikke deltog",
        "Apology Pre-resolution/Event Agenda Update Email": "Vi har desværre oplevet et problem med dit event",
        "Microsoft Event On-Demand Registration Confirmation": "Bekræftelse af tilmelding til Microsoft-event on-demand"
      },
      "DE-DE": {
        "Registration confirmation": "Bestätigung für die Anmeldung zu einer Microsoft-Veranstaltung",
        "Waitlist confirmation / Registration Pending": "Ihre Anmeldung zur Microsoft-Veranstaltung steht aus",
        "Waitlist denied / Registration denied": "Status Ihrer Registrierung zur Microsoft-Veranstaltung",
        "Event update reschedule": "Änderungshinweis zur Microsoft-Veranstaltung für angemeldete Kund*innen",
        "Event Cancellation": "Stornierungshinweis für eine Microsoft-Veranstaltung für angemeldete Kund*innen",
        "Event reminder": "Erinnerung zur Microsoft-Veranstaltung",
        "Thank you for attending": "Vielen Dank für Ihre Teilnahme!",
        "Sorry we missed you": "Wir haben Sie vermisst!",
        "Apology Pre-resolution/Event Agenda Update Email": "Es tut uns leid, wir haben ein Problem mit Ihrer Veranstaltung festgestellt",
        "Microsoft Event On-Demand Registration Confirmation": "Anmeldebestätigung für die Microsoft-Veranstaltung"
      },
      "EL-GR": {
        "Registration confirmation": "Επιβεβαίωση εγγραφής σε συμβάν της Microsoft",
        "Waitlist confirmation / Registration Pending": "Εκκρεμής εγγραφή σε συμβάν της Microsoft",
        "Waitlist denied / Registration denied": "Ενημέρωση κατάστασης εγγραφής για συμβάν της Microsoft",
        "Event update reschedule": "Ειδοποίηση προς εγγεγραμμένους πελάτες για την αλλαγή συμβάντος της Microsoft",
        "Event Cancellation": "Ειδοποίηση προς εγγεγραμμένους πελάτες για την ακύρωση συμβάντος της Microsoft",
        "Event reminder": "Υπενθύμιση για συμβάν της Microsoft",
        "Thank you for attending": "Σας ευχαριστούμε που παραβρεθήκατε",
        "Sorry we missed you": "Λυπούμαστε που δεν συμμετείχατε",
        "Apology Pre-resolution/Event Agenda Update Email": "Λυπούμαστε, αντιμετωπίσαμε κάποιο πρόβλημα με την εκδήλωσή σας",
        "Microsoft Event On-Demand Registration Confirmation": "Επιβεβαίωση εγγραφής για συμβάν της Microsoft κατ' απαίτηση"
      },
      "EN-GB": {
        "Registration confirmation": "Microsoft Event Registration Confirmation",
        "Waitlist confirmation / Registration Pending": "Microsoft Event Registration Pending",
        "Waitlist denied / Registration denied": "Microsoft Event Registration Status Update",
        "Event update reschedule": "Microsoft Event Change Notice to Registered Customers",
        "Event Cancellation": "Microsoft Event Cancellation Notice to Registered Customers",
        "Event reminder": "Microsoft Event Reminder",
        "Thank you for attending": "Thank You For Attending",
        "Sorry we missed you": "We’re Sorry We Missed You",
        "Apology Pre-resolution/Event Agenda Update Email": "Sorry, we experienced an issue with your event",
        "Microsoft Event On-Demand Registration Confirmation": "Microsoft Event On-Demand Registration Confirmation"
      },
      "ES-ES": {
        "Registration confirmation": "Confirmación de registro en el evento de Microsoft",
        "Waitlist confirmation / Registration Pending": "Registro pendiente en el evento de Microsoft",
        "Waitlist denied / Registration denied": "Actualización del estado del evento de Microsoft",
        "Event update reschedule": "Aviso de cambio del evento de Microsoft para los clientes registrados",
        "Event Cancellation": "Aviso de cancelación del evento de Microsoft para los clientes registrados",
        "Event reminder": "Recordatorio del evento de Microsoft",
        "Thank you for attending": "Gracias por tu asistencia",
        "Sorry we missed you": "Lamentamos que te lo hayas perdido",
        "Apology Pre-resolution/Event Agenda Update Email": "Lo sentimos, hemos tenido un problema con tu evento",
        "Microsoft Event On-Demand Registration Confirmation": "Confirmación de registro en el evento a petición de Microsoft"
      },
      "ES-LA": {
        "Registration confirmation": "Confirmación de registro en el evento de Microsoft",
        "Waitlist confirmation / Registration Pending": "Registro en el evento de Microsoft pendiente",
        "Waitlist denied / Registration denied": "Actualización del estado del registro en el evento de Microsoft",
        "Event update reschedule": "Aviso de cambio del evento de Microsoft para clientes registrados",
        "Event Cancellation": "Aviso de cancelación del evento de Microsoft para clientes registrados",
        "Event reminder": "Recordatorio del evento de Microsoft",
        "Thank you for attending": "¡Gracias por asistir!",
        "Sorry we missed you": "¡Lamentamos que no haya asistido!",
        "Apology Pre-resolution/Event Agenda Update Email": "Lo sentimos, hemos experimentado un problema con su evento",
        "Microsoft Event On-Demand Registration Confirmation": "Confirmación de registro en el evento de Microsoft on-demand"
      },
      "FI-FI": {
        "Registration confirmation": "Microsoft-tapahtuman ilmoittautumisvahvistus",
        "Waitlist confirmation / Registration Pending": "Microsoftin tapahtuman ilmoittautuminen on vireillä",
        "Waitlist denied / Registration denied": "Microsoftin tapahtuman ilmoittautumisen tilapäivitys",
        "Event update reschedule": "Microsoft-tapahtuman muutosilmoitus ilmoittautuneille asiakkaille",
        "Event Cancellation": "Microsoft-tapahtuman peruutusilmoitus ilmoittautuneille asiakkaille",
        "Event reminder": "Muistutus Microsoftin tapahtumasta",
        "Thank you for attending": "Kiitos osallistumisesta",
        "Sorry we missed you": "Harmi, ettet päässyt osallistumaan",
        "Apology Pre-resolution/Event Agenda Update Email": "Tapahtumaan liittyen ilmeni valitettavasti ongelma",
        "Microsoft Event On-Demand Registration Confirmation": "Tallennetun Microsoft-tapahtuman ilmoittautumisvahvistus"
      },
      "FR-CA": {
        "Registration confirmation": "Confirmation d’inscription à l’événement Microsoft",
        "Waitlist confirmation / Registration Pending": "Inscription à l’événement Microsoft en attente",
        "Waitlist denied / Registration denied": "Mise à jour de l’état de l’inscription à l’événement Microsoft",
        "Event update reschedule": "Avis de modification d’événement Microsoft aux clients inscrits",
        "Event Cancellation": "Avis d’annulation d’événement Microsoft aux clients inscrits",
        "Event reminder": "Rappel d’événement Microsoft",
        "Thank you for attending": "Merci de votre participation",
        "Sorry we missed you": "Nous regrettons votre absence",
        "Apology Pre-resolution/Event Agenda Update Email": "Désolés, un problème est survenu avec votre événement",
        "Microsoft Event On-Demand Registration Confirmation": "Confirmation d’inscription à l’événement Microsoft sur demande"
      },
      "FR-FR": {
        "Registration confirmation": "Confirmation de l’inscription à un événement Microsoft",
        "Waitlist confirmation / Registration Pending": "Inscription à un événement Microsoft en attente",
        "Waitlist denied / Registration denied": "Mise à jour du statut de l’inscription à un événement Microsoft",
        "Event update reschedule": "Avis de modification d’un événement Microsoft pour les clients inscrits",
        "Event Cancellation": "Avis d’annulation d’un événement Microsoft pour les clients inscrits",
        "Event reminder": "Rappel d’un événement Microsoft",
        "Thank you for attending": "Nous vous remercions de votre participation !",
        "Sorry we missed you": "Nous regrettons votre absence !",
        "Apology Pre-resolution/Event Agenda Update Email": "Désolé, nous avons rencontré un problème avec votre événement",
        "Microsoft Event On-Demand Registration Confirmation": "Confirmation de l'inscription au webinar à la demande de Microsoft"
      },
      "HE-IL": {
        "Registration confirmation": "אישור רישום לאירוע של Microsoft",
        "Waitlist confirmation / Registration Pending": "רישום לאירוע של Microsoft בהמתנה",
        "Waitlist denied / Registration denied": "עדכון מצב הרישום לאירוע של Microsoft",
        "Event update reschedule": "הודעה על שינוי אירוע של Microsoft עבור לקוחות שנרשמו",
        "Event Cancellation": "הודעה על ביטול אירוע של Microsoft עבור לקוחות שנרשמו",
        "Event reminder": "תזכורת לאירוע של Microsoft",
        "Thank you for attending": "אנו מודים לך על השתתפותך",
        "Sorry we missed you": "אנו מצטערים שלא הצלחת להגיע",
        "Apology Pre-resolution/Event Agenda Update Email": "מצטערים, נתקלנו בבעיה בהרשמה שלכם",
        "Microsoft Event On-Demand Registration Confirmation": "אישור רישום לאירוע לפי דרישה של Microsoft"
      },
      "HR-HR": {
        "Registration confirmation": "Potvrda registracije za Microsoftov događaj",
        "Waitlist confirmation / Registration Pending": "Registracije za Microsoftov događaj na čekanju",
        "Waitlist denied / Registration denied": "Ažuriranje stanja registracije za Microsoftov događaj",
        "Event update reschedule": "Obavijest registriranim korisnicima o promjeni Microsoftova događaja",
        "Event Cancellation": "Obavijest registriranim korisnicima o otkazivanju Microsoftova događaja",
        "Event reminder": "Podsjetnik na Microsoftov događaj",
        "Thank you for attending": "Hvala vam što ste sudjelovali",
        "Sorry we missed you": "Žao nam je, nedostajali ste nam",
        "Apology Pre-resolution/Event Agenda Update Email": "Žao nam je, došlo je do problema s vašim događajem",
        "Microsoft Event On-Demand Registration Confirmation": "Potvrda registracije za Microsoftov događaj na zahtjev"
      },
      "HU-HU": {
        "Registration confirmation": "Microsoft-eseményre való regisztráció visszaigazolása",
        "Waitlist confirmation / Registration Pending": "Microsoft-eseményre való regisztráció függőben",
        "Waitlist denied / Registration denied": "Microsoft-eseményre való regisztrációval kapcsolatos állapotfrissítés",
        "Event update reschedule": "Értesítés Microsoft-eseményt érintő változásról regisztrált ügyfeleknek",
        "Event Cancellation": "Értesítés Microsoft-esemény lemondásáról regisztrált ügyfeleknek",
        "Event reminder": "Microsoft-eseménnyel kapcsolatos emlékeztető",
        "Thank you for attending": "Köszönjük részvételét!",
        "Sorry we missed you": "Sajnáljuk, hogy nem tudott részt venni az eseményen!",
        "Apology Pre-resolution/Event Agenda Update Email": "Sajnálatos módon problémát tapasztaltunk az eseménnyel kapcsolatban",
        "Microsoft Event On-Demand Registration Confirmation": "Felvételről elérhető Microsoft-eseményre való regisztráció visszaigazolása"
      },
      "ID-ID": {
        "Registration confirmation": "Konfirmasi Pendaftaran Acara Microsoft",
        "Waitlist confirmation / Registration Pending": "Penundaan Pendaftaran Acara Microsoft",
        "Waitlist denied / Registration denied": "Pembaruan Status Pendaftaran Acara Microsoft",
        "Event update reschedule": "Pemberitahuan tentang Perubahan Acara Microsoft kepada Pelanggan Terdaftar",
        "Event Cancellation": "Pemberitahuan Pembatalan Acara Microsoft kepada Pelanggan Terdaftar",
        "Event reminder": "Pengingat Acara Microsoft",
        "Thank you for attending": "Terima Kasih Telah Mengikuti Acara Ini",
        "Sorry we missed you": "Maaf, Anda Telah Melewatkan Kesempatan Ini!",
        "Apology Pre-resolution/Event Agenda Update Email": "Maaf, kami mengalami masalah dengan acara Anda",
        "Microsoft Event On-Demand Registration Confirmation": "Konfirmasi Pendaftaran Acara Microsoft Sesuai Permintaan"
      },
      "IT-IT": {
        "Registration confirmation": "Conferma della registrazione all'evento Microsoft",
        "Waitlist confirmation / Registration Pending": "Registrazione in attesa per l'evento Microsoft",
        "Waitlist denied / Registration denied": "Aggiornamento dello stato della registrazione all'evento Microsoft",
        "Event update reschedule": "Avviso di modifica evento Microsoft ai clienti registrati",
        "Event Cancellation": "Avviso di cancellazione dell'evento Microsoft ai clienti registrati",
        "Event reminder": "Promemoria dell'evento Microsoft",
        "Thank you for attending": "Grazie per la partecipazione!",
        "Sorry we missed you": "Ci dispiace che tu abbia perso l'evento",
        "Apology Pre-resolution/Event Agenda Update Email": "Purtroppo abbiamo riscontrato un problema con il tuo evento",
        "Microsoft Event On-Demand Registration Confirmation": "Conferma della registrazione all'evento Microsoft on-demand"
      },
      "JA-JP": {
        "Registration confirmation": "マイクロソフトのイベントへの登録のご確認",
        "Waitlist confirmation / Registration Pending": "マイクロソフトのイベントへの登録の保留",
        "Waitlist denied / Registration denied": "登録ステータスの更新- マイクロソフト イベント",
        "Event update reschedule": "マイクロソフトのイベントに登録されたお客様へ変更のお知らせ",
        "Event Cancellation": "マイクロソフトのイベントに登録されたお客様へキャンセルのお知らせ",
        "Event reminder": "マイクロソフト イベントのリマインダー",
        "Thank you for attending": "ご参加いただき、ありがとうございます",
        "Sorry we missed you": "ご参加いただけず残念でした",
        "Apology Pre-resolution/Event Agenda Update Email": "申し訳ございません。お客様のイベントで問題が発生しました",
        "Microsoft Event On-Demand Registration Confirmation": "マイクロソフトのオンデマンド イベントへの登録のご確認"
      },
      "KO-KR": {
        "Registration confirmation": "Microsoft 이벤트 등록 완료 안내",
        "Waitlist confirmation / Registration Pending": "Microsoft 이벤트 등록 보류",
        "Waitlist denied / Registration denied": "Microsoft 이벤트 등록 상태 변경 안내",
        "Event update reschedule": "등록된 고객에게 Microsoft 이벤트 변경 안내",
        "Event Cancellation": "등록된 고객에게 Microsoft 이벤트 취소 안내",
        "Event reminder": "Microsoft 이벤트 미리 알림",
        "Thank you for attending": "참석해 주셔서 감사합니다",
        "Sorry we missed you": "뵙지 못해 아쉽습니다.",
        "Apology Pre-resolution/Event Agenda Update Email": "죄송합니다. 이벤트에 문제가 발생했습니다.",
        "Microsoft Event On-Demand Registration Confirmation": "Microsoft 이벤트 온디맨드 등록 확인"
      },
      "LT-LT": {
        "Registration confirmation": "Registracijos į „Microsoft“ įvykį patvirtinimas",
        "Waitlist confirmation / Registration Pending": "Registracija į „Microsoft“ įvykį laukia patvirtinimo",
        "Waitlist denied / Registration denied": "Registracijos į „Microsoft“ įvykį būsenos atnaujinimas",
        "Event update reschedule": "„Microsoft“ pranešimas apie įvykio pasikeitimą registruotiems klientams",
        "Event Cancellation": "„Microsoft“ pranešimas apie įvykio atšaukimą registruotiems klientams",
        "Event reminder": "Priminimas apie „Microsoft“ įvykį",
        "Thank you for attending": "Dėkojame, kad dalyvavote",
        "Sorry we missed you": "Apgailestaujame, kad negalėjote dalyvauti",
        "Apology Pre-resolution/Event Agenda Update Email": "Atsiprašome, susiduriame su techninėmis problemomis dėl jūsų renginio",
        "Microsoft Event On-Demand Registration Confirmation": "Registracijos į „Microsoft“ užsakomąjį renginį patvirtinimas"
      },
      "NB-NO": {
        "Registration confirmation": "Bekreftelse for påmelding til Microsoft-arrangementet",
        "Waitlist confirmation / Registration Pending": "Påmeldingen din til Microsoft‑arrangementet er satt på vent",
        "Waitlist denied / Registration denied": "Statusoppdatering for påmeldingen din til Microsoft‑arrangementet",
        "Event update reschedule": "Varsel om endring av Microsoft‑arrangement for påmeldte kunder",
        "Event Cancellation": "Varsel om avlysning av Microsoft‑arrangement for registrerte kunder",
        "Event reminder": "Påminnelse om Microsoft‑arrangement",
        "Thank you for attending": "Takk for at du kom!",
        "Sorry we missed you": "Trist at du ikke kom",
        "Apology Pre-resolution/Event Agenda Update Email": "Beklager, det har oppstått et problem med arrangementet",
        "Microsoft Event On-Demand Registration Confirmation": "Bekreftelse av påmelding til Microsoft‑arrangementet"
      },
      "NL-NL": {
        "Registration confirmation": "Microsoft-evenement: aanmeldingsbevestiging",
        "Waitlist confirmation / Registration Pending": "Microsoft-evenement: aanmelding in afwachting",
        "Waitlist denied / Registration denied": "Microsoft-evenement: update status aanmelding",
        "Event update reschedule": "Microsoft-evenement: wijzigingsbericht voor aangemelde klanten",
        "Event Cancellation": "Microsoft-evenement: annuleringsbericht voor aangemelde klanten",
        "Event reminder": "Herinnering voor je Microsoft-evenement",
        "Thank you for attending": "Bedankt voor je deelname",
        "Sorry we missed you": "Jammer dat je er niet bij kon zijn",
        "Apology Pre-resolution/Event Agenda Update Email": "Sorry, er is een probleem met je evenement opgetreden",
        "Microsoft Event On-Demand Registration Confirmation": "Bevestiging van registratie voor on-demand Microsoft-evenement"
      },
      "PL-PL": {
        "Registration confirmation": "Potwierdzenie rejestracji na wydarzenie Microsoft",
        "Waitlist confirmation / Registration Pending": "Rejestracja na wydarzenie Microsoft oczekuje",
        "Waitlist denied / Registration denied": "Aktualizacja stanu rejestracji na wydarzenie Microsoft",
        "Event update reschedule": "Powiadomienie o zmianie dotyczącej wydarzenia Microsoft dla zarejestrowanych klientów",
        "Event Cancellation": "Powiadomienie o anulowaniu wydarzenia Microsoft dla zarejestrowanych klientów",
        "Event reminder": "Przypomnienie o wydarzeniu Microsoft",
        "Thank you for attending": "Dziękujemy za udział",
        "Sorry we missed you": "Przykro nam, że nie było Cię z nami",
        "Apology Pre-resolution/Event Agenda Update Email": "Przepraszamy, wystąpił problem z Twoim wydarzeniem",
        "Microsoft Event On-Demand Registration Confirmation": "Potwierdzenie rejestracji na wydarzenie Microsoft na żądanie"
      },
      "PT-BR": {
        "Registration confirmation": "Confirmação da inscrição no evento da Microsoft",
        "Waitlist confirmation / Registration Pending": "Inscrição no evento da Microsoft pendente",
        "Waitlist denied / Registration denied": "Atualização do status da inscrição no evento da Microsoft",
        "Event update reschedule": "Aviso de alteração aos clientes inscritos no evento da Microsoft",
        "Event Cancellation": "Aviso de cancelamento aos clientes inscritos no evento da Microsoft",
        "Event reminder": "Lembrete do evento da Microsoft",
        "Thank you for attending": "Agradecemos sua participação",
        "Sorry we missed you": "Sentimos sua falta",
        "Apology Pre-resolution/Event Agenda Update Email": "Desculpe, tivemos um problema com o seu evento.",
        "Microsoft Event On-Demand Registration Confirmation": "Confirmação de registro do evento da Microsoft"
      },
      "PT-PT": {
        "Registration confirmation": "Confirmação de Registo no Evento da Microsoft",
        "Waitlist confirmation / Registration Pending": "Registo no Evento da Microsoft Pendente",
        "Waitlist denied / Registration denied": "Atualização do Estado do Registo no Evento da Microsoft",
        "Event update reschedule": "Aviso de Alteração de Evento da Microsoft aos Clientes Registados",
        "Event Cancellation": "Aviso de Cancelamento do Evento da Microsoft aos Clientes Registados",
        "Event reminder": "Lembrete de Evento da Microsoft",
        "Thank you for attending": "Obrigado por Participar",
        "Sorry we missed you": "Lamentamos que Não Tenha Podido Participar",
        "Apology Pre-resolution/Event Agenda Update Email": "Desculpe, tivemos um problema com o seu evento",
        "Microsoft Event On-Demand Registration Confirmation": "Confirmação de Registo no Evento On-Demand da Microsoft"
      },
      "RO-RO": {
        "Registration confirmation": "Confirmare înregistrare la un eveniment Microsoft",
        "Waitlist confirmation / Registration Pending": "Înregistrare la evenimentul Microsoft în așteptare",
        "Waitlist denied / Registration denied": "Actualizare stare înregistrare la evenimentul Microsoft",
        "Event update reschedule": "Notificare de modificare eveniment Microsoft pentru clienții înregistrați",
        "Event Cancellation": "Notificare de anulare eveniment Microsoft pentru clienții înregistrați",
        "Event reminder": "Memento eveniment Microsoft",
        "Thank you for attending": "Vă mulțumim pentru participare",
        "Sorry we missed you": "Ne pare rău că nu ne-am văzut.",
        "Apology Pre-resolution/Event Agenda Update Email": "Ne pare rău, am întâmpinat o problemă cu evenimentul dvs.",
        "Microsoft Event On-Demand Registration Confirmation": "Confirmare înregistrare la cerere la evenimentul Microsoft"
      },
      "RU-RU": {
        "Registration confirmation": "Подтверждение регистрации на мероприятие Microsoft",
        "Waitlist confirmation / Registration Pending": "Ожидание регистрации на мероприятие Microsoft",
        "Waitlist denied / Registration denied": "Обновление состояния регистрации на мероприятие Microsoft",
        "Event update reschedule": "Уведомление для зарегистрированных клиентов об изменении мероприятия Microsoft",
        "Event Cancellation": "Уведомление для зарегистрированных клиентов об отмене мероприятия Microsoft",
        "Event reminder": "Напоминание о мероприятии Microsoft",
        "Thank you for attending": "Благодарим за участие!",
        "Sorry we missed you": "Нам жаль, что Вы пропустили мероприятие",
        "Apology Pre-resolution/Event Agenda Update Email": "Извините, с вашим мероприятием возникла проблема",
        "Microsoft Event On-Demand Registration Confirmation": "Подтверждение регистрации для участия в мероприятии Microsoft по запросу"
      },
      "SK-SK": {
        "Registration confirmation": "Potvrdenie registrácie na udalosť Microsoftu",
        "Waitlist confirmation / Registration Pending": "Registrácia na udalosť Microsoftu sa spracúva",
        "Waitlist denied / Registration denied": "Aktualizácia stavu registrácie na udalosť Microsoftu",
        "Event update reschedule": "Oznámenie o zmene udalosti Microsoftu registrovaným zákazníkom",
        "Event Cancellation": "Oznámenie o zrušení udalosti Microsoftu registrovaným zákazníkom",
        "Event reminder": "Pripomenutie udalosti Microsoftu",
        "Thank you for attending": "Ďakujeme za účasť",
        "Sorry we missed you": "Mrzí nás to. Chýbali ste nám.",
        "Apology Pre-resolution/Event Agenda Update Email": "Ľutujeme, vyskytol sa nejaký problém s podujatím, ktorého sa plánujete zúčastniť",
        "Microsoft Event On-Demand Registration Confirmation": "Potvrdenie registrácie na udalosť Microsoftu na požiadanie"
      },
      "SL-SI": {
        "Registration confirmation": "Potrditev registracije za dogodek družbe Microsoft",
        "Waitlist confirmation / Registration Pending": "Registracija za dogodek družbe Microsoft je v teku",
        "Waitlist denied / Registration denied": "Posodobitev stanja registracije za dogodek družbe Microsoft",
        "Event update reschedule": "Obvestilo o spremembi glede dogodka družbe Microsoft za registrirane stranke",
        "Event Cancellation": "Obvestilo o preklicu dogodka družbe Microsoft za registrirane stranke",
        "Event reminder": "Opomnik za dogodek družbe Microsoft",
        "Thank you for attending": "Hvala za udeležbo",
        "Sorry we missed you": "Žal nam je, da se niste mogli udeležiti dogodka",
        "Apology Pre-resolution/Event Agenda Update Email": "Žal je prišlo do težave z dogodkom",
        "Microsoft Event On-Demand Registration Confirmation": "Potrditev registracije za dogodek družbe Microsoft na zahtevo"
      },
      "SV-SE": {
        "Registration confirmation": "Bekräftelse på anmälan till Microsoft-event",
        "Waitlist confirmation / Registration Pending": "Anmälan till Microsoft-eventet behandlas",
        "Waitlist denied / Registration denied": "Statusuppdatering för anmälan till Microsoft-event",
        "Event update reschedule": "Meddelande om ett ändrat Microsoft-event till anmälda kunder",
        "Event Cancellation": "Meddelande till anmälda kunder om ett inställt Microsoft-event",
        "Event reminder": "Påminnelse om Microsoft-event",
        "Thank you for attending": "Tack för att du deltog",
        "Sorry we missed you": "Det var synd att du inte kunde delta",
        "Apology Pre-resolution/Event Agenda Update Email": "Det har tyvärr uppstått ett problem med ditt event",
        "Microsoft Event On-Demand Registration Confirmation": "Bekräftelse på anmälan till Microsofts on-demand-event"
      },
      "TH-TH": {
        "Registration confirmation": "การยืนยันการลงทะเบียนกิจกรรมของ Microsoft",
        "Waitlist confirmation / Registration Pending": "การลงทะเบียนกิจกรรมของ Microsoft อยู่ระหว่างการดำเนินการ",
        "Waitlist denied / Registration denied": "การอัปเดตสถานะการลงทะเบียนกิจกรรมของ Microsoft",
        "Event update reschedule": "ประกาศแจ้งเตือนการเปลี่ยนแปลงกิจกรรมของ Microsoft ไปยังลูกค้าที่ลงทะเบียน",
        "Event Cancellation": "ประกาศแจ้งการยกเลิกกิจกรรมของ Microsoft ไปยังลูกค้าที่ลงทะเบียน",
        "Event reminder": "การแจ้งเตือนกิจกรรมของ Microsoft",
        "Thank you for attending": "ขอบคุณที่เข้าร่วม",
        "Sorry we missed you": "เราเสียใจที่คุณไม่ได้เข้าร่วม",
        "Apology Pre-resolution/Event Agenda Update Email": "ขออภัย เราประสบปัญหาเกี่ยวกับกิจกรรมของคุณ",
        "Microsoft Event On-Demand Registration Confirmation": "การยืนยันการลงทะเบียนกิจกรรมของ Microsoft ตามความต้องการ"
      },
      "TR-TR": {
        "Registration confirmation": "Microsoft Etkinlik Kaydı Onayı",
        "Waitlist confirmation / Registration Pending": "Microsoft Etkinlik Kaydı Onayı Beklemede",
        "Waitlist denied / Registration denied": "Microsoft Olay Kaydı Durum Güncellemesi",
        "Event update reschedule": "Kayıtlı Müşteriler İçin Microsoft Etkinlik Değişikliği Bildirimi",
        "Event Cancellation": "Kayıtlı Müşteriler İçin Microsoft Etkinlik İptali Bildirimi",
        "Event reminder": "Microsoft Etkinlik Hatırlatıcısı",
        "Thank you for attending": "Katıldığınız için teşekkürler.",
        "Sorry we missed you": "Sizinle Olamadığımız İçin Üzgünüz",
        "Apology Pre-resolution/Event Agenda Update Email": "Üzgünüz, etkinliğinizle ilgili bir sorun yaşadık",
        "Microsoft Event On-Demand Registration Confirmation": "İsteğe Bağlı Microsoft Etkinlik Kaydı Onayı"
      },
      "UK-UA": {
        "Registration confirmation": "Підтвердження реєстрації для участі в заході корпорації Майкрософт",
        "Waitlist confirmation / Registration Pending": "Очікується підтвердження реєстрації для участі в заході корпорації Майкрософт",
        "Waitlist denied / Registration denied": "Оновлення стану реєстрації для участі в заході корпорації Майкрософт",
        "Event update reschedule": "Повідомлення зареєстрованим клієнтам про зміну місця або часу проведення заходу корпорації Майкрософт",
        "Event Cancellation": "Повідомлення зареєстрованим клієнтам про скасування заходу корпорації Майкрософт",
        "Event reminder": "Нагадування про захід корпорації Майкрософт",
        "Thank you for attending": "Дякуємо за участь",
        "Sorry we missed you": "Шкода, що Вас не було",
        "Apology Pre-resolution/Event Agenda Update Email": "Вибачте, у нас виникла проблема з вашою участю в заході",
        "Microsoft Event On-Demand Registration Confirmation": "Підтвердження реєстрації за запитом для участі в заході корпорації Майкрософт"
      },
      "VI-VN": {
        "Registration confirmation": "Xác nhận thông tin đăng ký sự kiện Microsoft",
        "Waitlist confirmation / Registration Pending": "Thông tin đăng ký sự kiện Microsoft đang chờ xử lý",
        "Waitlist denied / Registration denied": "Cập nhật trạng thái đăng ký sự kiện Microsoft",
        "Event update reschedule": "Thông báo thay đổi sự kiện của Microsoft cho Khách hàng đã đăng ký",
        "Event Cancellation": "Thông báo hủy sự kiện của Microsoft cho Khách hàng đã đăng ký",
        "Event reminder": "Lời nhắc về sự kiện Microsoft",
        "Thank you for attending": "Cảm ơn bạn đã tham dự",
        "Sorry we missed you": "Chúng tôi rất tiếc vì đã bỏ lỡ bạn",
        "Apology Pre-resolution/Event Agenda Update Email": "Xin lỗi, chúng tôi đã gặp sự cố với sự kiện của bạn",
        "Microsoft Event On-Demand Registration Confirmation": "Xác nhận Đăng ký Sự kiện Microsoft Theo Yêu cầu"
      },
      "ZH-CN": {
        "Registration confirmation": "Microsoft 活动注册确认",
        "Waitlist confirmation / Registration Pending": "Microsoft 活动注册待确认",
        "Waitlist denied / Registration denied": "Microsoft 活动注册状态更新",
        "Event update reschedule": "Microsoft 针对注册客户的活动更改通知",
        "Event Cancellation": "Microsoft 针对注册客户的活动取消通知",
        "Event reminder": "Microsoft 活动提醒",
        "Thank you for attending": "感谢参加",
        "Sorry we missed you": "很遗憾你未能参加活动",
        "Apology Pre-resolution/Event Agenda Update Email": "抱歉，你注册的活动出现了一点问题",
        "Microsoft Event On-Demand Registration Confirmation": "Microsoft 活动点播内容注册确认"
      },
      "ZH-HK": {
        "Registration confirmation": "Microsoft 活動登記確認",
        "Waitlist confirmation / Registration Pending": "Microsoft 活動登記待確認",
        "Waitlist denied / Registration denied": "Microsoft 活動登記狀態更新",
        "Event update reschedule": "給已登記客戶的 Microsoft 活動變更通知",
        "Event Cancellation": "給已登記客戶的 Microsoft 活動取消通知",
        "Event reminder": "Microsoft 活動提醒",
        "Thank you for attending": "感謝您的出席",
        "Sorry we missed you": "很遺憾您錯過這次研討會",
        "Apology Pre-resolution/Event Agenda Update Email": "很抱歉，您的活動遇到問題",
        "Microsoft Event On-Demand Registration Confirmation": "Microsoft 活動隨選點播登記確認"
      },
      "ZH-TW": {
        "Registration confirmation": "Microsoft 活動登記確認",
        "Waitlist confirmation / Registration Pending": "Microsoft 活動登記待確認",
        "Waitlist denied / Registration denied": "Microsoft 活動登記狀態更新",
        "Event update reschedule": "給已登記客戶的 Microsoft 活動變更通知",
        "Event Cancellation": "給已登記客戶的 Microsoft 活動取消通知",
        "Event reminder": "Microsoft 活動提醒",
        "Thank you for attending": "感謝您的出席",
        "Sorry we missed you": "很遺憾您錯過這次研討會",
        "Apology Pre-resolution/Event Agenda Update Email": "很抱歉，您的活動遇到問題",
        "Microsoft Event On-Demand Registration Confirmation": "Microsoft 活動隨選點播登記確認"
      }
    };
 /* === Description strings aligned to ORDER keys === */
    const DESCRIPTIONS_IN_EMC = {
      "Registration confirmation": "RegistrationConfirmation email for event",
      "Waitlist confirmation / Registration Pending": "WaitlistConfirmation / RegistrationPending email for event",
      "Waitlist denied / Registration denied": "WaitlistDenied / Registrationdenied email for event",
      "Event update reschedule": "EventScheduleUpdate email for event",
      "Event Cancellation": "EventCancellation email for event",
      "Event reminder": "EventReminder (T3,T1) email for event",
      "Thank you for attending": "EventAttended email for event",
      "Sorry we missed you": "EventMissed email for event",
      "Apology Pre-resolution/Event Agenda Update Email": "EventAgendaUpdate email for event",
      "Microsoft Event On-Demand Registration Confirmation": "RegistrationOnDemandConfirmation email for event"
    };

    const ONDEMAND_KEY = "Microsoft Event On-Demand Registration Confirmation";
    const ORDER = [
      "Registration confirmation",
      "Waitlist confirmation / Registration Pending",
      "Waitlist denied / Registration denied",
      "Event update reschedule",
      "Event Cancellation",
      "Event reminder",
      "Thank you for attending",
      "Sorry we missed you",
      "Apology Pre-resolution/Event Agenda Update Email",
      "Microsoft Event On-Demand Registration Confirmation"
    ];

    const LS_KEYS = {
      theme: 'sl_theme', lang: 'sl_lang', includeOD: 'sl_include_od', showDesc: 'sl_show_desc',
      mvtdEvent: 'mvtd_event', mvtdLang: 'mvtd_lang', mvtdDay: 'mvtd_day'
    };
    const RTL_LANGS = ['AR-SA','HE-IL'];

    function announce(msg){const t=document.getElementById('toast');t.textContent=msg;t.classList.add('show');clearTimeout(announce._t);announce._t=setTimeout(()=>t.classList.remove('show'),1200);}
    function copyTextFallback(text){const ta=document.createElement('textarea');ta.value=text;ta.setAttribute('readonly','');ta.style.position='fixed';ta.style.opacity='0';ta.style.left='-9999px';document.body.appendChild(ta);ta.select();document.execCommand('copy');document.body.removeChild(ta);announce('Copied');}
    async function copyText(txt){const clean=(txt||'').toString().trim();if(!clean){announce('Nothing to copy');return;}try{if(navigator.clipboard?.writeText){await navigator.clipboard.writeText(clean);announce('Copied');}else{copyTextFallback(clean);}}catch{copyTextFallback(clean);}}

    const langButton=document.getElementById('langButton');
    const langList=document.getElementById('langList');
    const langSelectRoot=document.getElementById('langSelectRoot');

    let currentLang='EN';
    const themes=['light','dark','blue']; let currentThemeIndex=0;
    let includeOnDemand=false; let showDescription=true;

    function buildLanguageList(){
      langList.innerHTML=''; const frag=document.createDocumentFragment();
      Object.keys(DATA).forEach(code=>{
        const li=document.createElement('li'); li.setAttribute('role','option'); li.setAttribute('tabindex','-1'); li.textContent=code; li.dataset.value=code;
        if(code===currentLang) li.setAttribute('aria-selected','true');
        li.addEventListener('click',()=>{selectLanguage(code);closeLangList();});
        li.addEventListener('keydown',(e)=>{if(e.key==='Enter'){selectLanguage(code);closeLangList();}});
        frag.appendChild(li);
      });
      langList.appendChild(frag);
    }
    function openLangList(){langList.setAttribute('aria-hidden','false');langButton.setAttribute('aria-expanded','true');(langList.querySelector('[aria-selected="true"]')||langList.querySelector('li'))?.focus();document.addEventListener('click',onDocClickCloseLang,{once:true});}
    function closeLangList(){langList.setAttribute('aria-hidden','true');langButton.setAttribute('aria-expanded','false');langButton.focus();}
    function onDocClickCloseLang(e){if(!langSelectRoot.contains(e.target)) closeLangList();}

    langButton.addEventListener('click',()=>{const ex=langButton.getAttribute('aria-expanded')==='true';ex?closeLangList():openLangList();});
    langButton.addEventListener('keydown',(e)=>{if(['ArrowDown','Enter',' '].includes(e.key)){e.preventDefault();openLangList();}});
    langList.addEventListener('keydown',(e)=>{if(e.key==='Escape'){e.preventDefault();closeLangList();}});

    const onDemandBtn=document.getElementById('onDemandBtn');
    onDemandBtn.addEventListener('click',()=>{includeOnDemand=!includeOnDemand;onDemandBtn.setAttribute('aria-pressed',String(includeOnDemand));onDemandBtn.textContent=includeOnDemand?'Include On‑Demand (ON)':'Include On‑Demand';savePrefs();renderTable();});

    const themeBtn=document.getElementById('themeBtn');
    themeBtn.addEventListener('click',()=>{currentThemeIndex=(currentThemeIndex+1)%themes.length;const t=themes[currentThemeIndex];document.body.className=t;themeBtn.textContent=`Theme: ${t[0].toUpperCase()+t.slice(1)}`;savePrefs();});

    const descToggleBtn=document.getElementById('descToggleBtn');
    function applyDescVisibility(){const tbl=document.getElementById('subjectTable');if(showDescription){tbl.classList.remove('desc-hidden');descToggleBtn.textContent='Show Description (ON)';descToggleBtn.setAttribute('aria-pressed','true');}else{tbl.classList.add('desc-hidden');descToggleBtn.textContent='Show Description (OFF)';descToggleBtn.setAttribute('aria-pressed','false');}}
    descToggleBtn.addEventListener('click',()=>{showDescription=!showDescription;applyDescVisibility();savePrefs();});

    function loadPrefs(){
      const savedTheme=localStorage.getItem(LS_KEYS.theme);
      const savedLang=localStorage.getItem(LS_KEYS.lang);
      const savedOD=localStorage.getItem(LS_KEYS.includeOD);
      const savedDesc=localStorage.getItem(LS_KEYS.showDesc);

      if(savedTheme&&['light','dark','blue'].includes(savedTheme)){document.body.className=savedTheme;themeBtn.textContent=`Theme: ${savedTheme[0].toUpperCase()+savedTheme.slice(1)}`;currentThemeIndex=['light','dark','blue'].indexOf(savedTheme);}
      if(savedLang&&DATA[savedLang]){currentLang=savedLang;langButton.textContent=savedLang;}
      includeOnDemand=savedOD==='true'; onDemandBtn.setAttribute('aria-pressed',String(includeOnDemand)); onDemandBtn.textContent=includeOnDemand?'Include On‑Demand (ON)':'Include On‑Demand';
      showDescription=savedDesc!=='false'; applyDescVisibility();
    }
    function savePrefs(){
      localStorage.setItem(LS_KEYS.theme,document.body.className||'light');
      localStorage.setItem(LS_KEYS.lang,currentLang||'EN');
      localStorage.setItem(LS_KEYS.includeOD,String(includeOnDemand));
      localStorage.setItem(LS_KEYS.showDesc,String(showDescription));
    }
    function applyDirForLang(code){document.body.setAttribute('dir', RTL_LANGS.includes(code)?'rtl':'ltr');}

    function renderTable(){
      const selectedLang=currentLang||'EN';
      document.getElementById('langLabel').textContent=`Language: ${selectedLang}`;
      const enSubjects=DATA['EN']; const locSubjects=DATA[selectedLang];
      const tbody=document.querySelector('#subjectTable tbody'); tbody.innerHTML='';

      const keys=ORDER.filter(k=>includeOnDemand?true:k!==ONDEMAND_KEY);
      keys.forEach((key,idx)=>{
        const tr=document.createElement('tr');
        const localizedText=(locSubjects && key in locSubjects) ? (locSubjects[key]||'') : '';
        tr.innerHTML = `
          <td class="snCol">${idx+1}</td>
          <td class="enCol">${enSubjects[key]||''}</td>
          <td class="descCol">${DESCRIPTIONS_IN_EMC[key]||''}</td>
          <td>${localizedText}</td>
          <td><button class="copy-btn" ${!localizedText.trim()?'disabled':''}>Copy</button></td>
        `;
        tr.querySelector('button')?.addEventListener('click',()=>copyText(localizedText));
        tbody.appendChild(tr);
      });
      applyDescVisibility();
      applyDirForLang(selectedLang);
    }

    function selectLanguage(val){
      currentLang=val; langButton.textContent=val;
      langList.querySelectorAll('li').forEach(li=>li.setAttribute('aria-selected', String(li.dataset.value===val)));
      renderTable(); savePrefs();
    }

    // Init localization
    buildLanguageList();
    loadPrefs();
    document.getElementById('langButton').textContent=currentLang;
    renderTable();

    /* ===== MVTD module (separate; does not touch localization) ===== */
    (function MVTDModule(){
      const mvtdBtn=document.getElementById('mvtdBtn');
      const mvtdForm=document.getElementById('mvtdForm');
      const mvtdEvent=document.getElementById('mvtdEvent');
      const mvtdLang=document.getElementById('mvtdLang');
      const mvtdDay=document.getElementById('mvtdDay');
      const mvtdSubmit=document.getElementById('mvtdSubmit');
      const mvtdReset=document.getElementById('mvtdReset');
      const mvtdResult=document.getElementById('mvtdResult');
      const mvtdScopeOut=document.getElementById('mvtdScopeOut');
      const mvtdLaunchOut=document.getElementById('mvtdLaunchOut');
      const mvtdSubjectOut=document.getElementById('mvtdSubjectOut');
      const mvtdFriendlyOut=document.getElementById('mvtdFriendlyOut');
      const mvtdCopySubject=document.getElementById('mvtdCopySubject');
      const mvtdCopyFriendly=document.getElementById('mvtdCopyFriendly');

      if(!mvtdBtn || !mvtdForm) return;

      const MVTD_DATA = [
        // FY25 — add all rows here
        // ---------- Azure & AI ----------
  {
    scope: 'FY25',
    eventSubType: 'Microsoft Azure Virtual Training Day: AI Fundamentals',
    languages: ['EN-US','EN-GB','FR-CA','FR-FR','ZH-CN','PT-BR','JA-JP','KO-KR','ES-XL','ES-ES','DE-DE'],
    dayFormats: ['2 Day'],
    launchDate: '20th September',
    subjectLine: 'Thanks for joining Azure AI Fundamentals',
    friendlyName: 'Microsoft Azure Virtual Training Day AI Fundamentals'
  },

  {
    scope: 'FY25',
    eventSubType: 'Microsoft 365 Virtual Training Day: Prepare Your Organization for Microsoft 365 Copilot',
    languages: ['EN-US','EN-GB','FR-CA','FR-FR','ZH-CN','JA-JP','KO-KR','ES-ES','ES-XL','DE-DE','PT-BR'],
    dayFormats: ['1 Day'],
    launchDate: '20th September',
    subjectLine: 'Thanks for joining Prepare Your Organization for Microsoft 365 Copilot',
    friendlyName: 'Microsoft 365 Virtual Training Day Prepare Your Organization for Microsoft 365 Copilot'
  },

  {
    scope: 'FY25',
    eventSubType: 'Microsoft Azure Virtual Training Day: Fundamentals',
    languages: ['EN-US','EN-GB','FR-CA','JA-JP','KO-KR','ES-XL','ES-ES','PT-BR','ZH-CN','FR-FR','DE-DE'],
    dayFormats: ['2 Day'],
    launchDate: '11th October',
    subjectLine: 'Thanks for joining Azure Fundamentals',
    friendlyName: 'Microsoft Azure Virtual Training Day Fundamentals'
  },

  {
    scope: 'FY25',
    eventSubType: 'Microsoft Azure Virtual Training Day: Develop Your Own Custom Copilots with Azure AI',
    languages: ['EN-US','EN-GB','FR-CA','ES-XL','ES-ES','ZH-CN'],
    dayFormats: ['2 Day'],
    launchDate: '11th October',
    subjectLine: 'Thanks for joining Develop Your Own Custom Copilots with Azure AI',
    friendlyName: 'Microsoft Azure Virtual Training Day Develop Your Own Custom Copilots with Azure AI'
  },

  {
    scope: 'FY25',
    eventSubType: 'Microsoft 365 Virtual Training Day: Fundamentals',
    languages: ['EN-US','EN-GB','FR-CA','FR-FR','ES-XL','ES-ES','DE-DE'],
    dayFormats: ['1 Day'],
    launchDate: '11th October',
    subjectLine: 'Thanks for joining Microsoft 365 Fundamentals',
    friendlyName: 'Microsoft 365 Virtual Training Day Fundamentals'
  },

  {
    scope: 'FY25',
    eventSubType: 'Microsoft Azure Virtual Training Day: Accelerate Development with GitHub Copilot',
    languages: ['EN-US','EN-GB','FR-CA'],
    dayFormats: ['2 Day'],
    launchDate: '25th October',
    subjectLine: 'Thanks for joining Accelerate Development with GitHub Copilot',
    friendlyName: 'Microsoft Azure Virtual Training Day Accelerate Development with GitHub Copilot'
  },

  {
    scope: 'FY25',
    eventSubType: 'Microsoft Azure Virtual Training Day: Implement a Lakehouse with Microsoft Fabric',
    languages: ['EN-US','EN-GB','FR-CA','DE-DE','FR-FR','ES-XL','ES-ES'],
    dayFormats: ['2 Day'],
    launchDate: '25th October',
    subjectLine: 'Thanks for joining Implement a Lakehouse with Microsoft Fabric',
    friendlyName: 'Microsoft Azure Virtual Training Day Implement a Lakehouse with Microsoft Fabric'
  },

  {
    scope: 'FY25',
    eventSubType: 'Microsoft Security Virtual Training Day: Defend Against Threats with Extended Detection and Response',
    languages: ['EN-US','EN-GB','FR-CA','ZH-CN','PT-BR','ES-XL','ES-ES','FR-FR','JA-JP','DE-DE'],
    dayFormats: ['2 Day'],
    launchDate: '25th October',
    subjectLine: 'Thanks for joining Defend Against Threats with Extended Detection and Response',
    friendlyName: 'Microsoft Security Virtual Training Day Defend Against Threats with Extended Detection and Response'
  },

  {
    scope: 'FY25',
    eventSubType: 'Microsoft Power Platform Virtual Training Day: Create Apps and Automations with Power Platform',
    languages: ['EN-US','EN-GB','FR-CA','ES-ES','ES-XL','PT-BR'],
    dayFormats: ['2 Day'],
    launchDate: '25th October',
    subjectLine: 'Thanks for joining Create Apps and Automations with Power Platform',
    friendlyName: 'Microsoft Power Platform Virtual Training Day Create Apps and Automations with Power Platform'
  },

  // ---------- Modern Work & Security (Nov launches) ----------
  {
    scope: 'FY25',
    eventSubType: 'Microsoft 365 Virtual Training Day: Manage Your Smart Workplace with Microsoft Teams',
    languages: ['EN-US','EN-GB','FR-CA'],
    dayFormats: ['2 Day'],
    launchDate: '8th November',
    subjectLine: 'Thanks for joining Manage Your Smart Workplace with Microsoft Teams',
    friendlyName: 'Microsoft 365 Virtual Training Day Manage Your Smart Workplace with Microsoft Teams'
  },

  {
    scope: 'FY25',
    eventSubType: 'Microsoft Security Virtual Training Day: Modernize your Security Operations with Microsoft Sentinel',
    languages: ['EN-US','EN-GB','FR-CA'],
    dayFormats: ['2 Day'],
    launchDate: '8th November',
    subjectLine: 'Thanks for joining Modernize your Security Operations with Microsoft Sentinel',
    friendlyName: 'Microsoft Security Virtual Training Day Modernize your Security Operations with Microsoft Sentinel'
  },

  {
    scope: 'FY25',
    eventSubType: 'Microsoft Security Virtual Training Day: Implement Data Security with Microsoft Purview',
    languages: ['EN-US','EN-GB','FR-CA','PT-BR','ZH-CN','ES-XL','ES-ES','FR-FR','DE-DE','JA-JP'],
    dayFormats: ['2 Day'],
    launchDate: '8th November',
    subjectLine: 'Thanks for joining Implement Data Security with Microsoft Purview',
    friendlyName: 'Microsoft Security Virtual Training Day Implement Data Security with Microsoft Purview'
  },

  {
    scope: 'FY25',
    eventSubType: 'Microsoft Power Platform Virtual Training Day: Fundamentals',
    languages: ['EN-US','EN-GB','FR-CA','PT-BR','ES-ES','ES-XL'],
    dayFormats: ['1 Day'],
    launchDate: '22nd November',
    subjectLine: 'Thanks for joining Power Platform Fundamentals',
    friendlyName: 'Microsoft Power Platform Virtual Training Day Fundamentals'
  },

  {
    scope: 'FY25',
    eventSubType: 'Microsoft Azure Virtual Training Day: Migrate and Secure Windows Server and SQL Server Workloads',
    languages: ['EN-US','EN-GB','FR-CA','JA-JP','FR-FR','ZH-CN','PT-BR','KO-KR','ES-XL','ES-ES'],
    dayFormats: ['2 Day'],
    launchDate: '22nd November',
    subjectLine: 'Thanks for joining Azure Migrate and Secure Windows Server and SQL Server Workloads',
    friendlyName: 'Microsoft Azure Virtual Training Day Migrate and Secure Windows Server and SQL Server Workloads'
  },

  {
    scope: 'FY25',
    eventSubType: 'Microsoft Power Platform Virtual Training Day: Create Agents in Microsoft Copilot Studio',
    languages: ['EN-US','EN-GB','FR-CA','ES-ES','ES-XL','PT-BR'],
    dayFormats: ['1 Day'],
    launchDate: '22nd November',
    subjectLine: 'Thanks for joining Power Platform Create Agents in Microsoft Copilot Studio',
    friendlyName: 'Microsoft Power Platform Virtual Training Day Create Agents in Microsoft Copilot Studio'
  },

  // ---------- December launches ----------
  {
    scope: 'FY25',
    eventSubType: 'Microsoft Azure Virtual Training Day: Data Fundamentals',
    languages: ['EN-US','EN-GB','FR-CA','ZH-CN','FR-FR','PT-BR','JA-JP','DE-DE','KO-KR','ES-XL','ES-ES'],
    dayFormats: ['2 Day'],
    launchDate: '9th December',
    subjectLine: 'Thanks for joining Azure Data Fundamentals',
    friendlyName: 'Microsoft Azure Virtual Training Day Data Fundamentals'
  },

  {
    scope: 'FY25',
    eventSubType: 'Microsoft Security Virtual Training Day: Security, Compliance, and Identity Fundamentals',
    languages: ['EN-US','EN-GB','FR-CA','ZH-CN','PT-BR','FR-FR','JA-JP','KO-KR','ES-ES','ES-XL','DE-DE'],
    dayFormats: ['2 Day'],
    launchDate: '9th December',
    subjectLine: 'Thanks for joining Security, Compliance, and Identity Fundamentals',
    friendlyName: 'Microsoft Security Virtual Training Day Security Compliance and Identity Fundamentals'
  },

  {
    scope: 'FY25',
    eventSubType: 'Microsoft Azure Virtual Training Day: Migrate and Modernize your Apps for AI-powered Solutions',
    languages: ['EN-US','EN-GB','FR-CA'],
    dayFormats: ['2 Day'],
    launchDate: '9th December',
    subjectLine: 'Thanks for joining Migrate and Modernize Your Apps for AI-powered Solutions',
    friendlyName: 'Microsoft Azure Virtual Training Day Migrate and Modernize your Apps for AI powered Solutions'
  },

  {
    scope: 'FY25',
    eventSubType: 'Microsoft 365 Virtual Training Day: Enable Your Frontline with Secure, Simple, and Smart Solutions',
    languages: ['EN-US','FR-CA','EN-GB'],
    dayFormats: ['2 Day'],
    launchDate: '30th December',
    subjectLine: 'Thanks for joining Enable Your Frontline with Secure, Simple, and Smart Solutions',
    friendlyName: 'Microsoft 365 Virtual Training Day Enable Your Frontline with Secure Simple and Smart Solutions'
  },

  {
    scope: 'FY25',
    eventSubType: 'Microsoft Azure Virtual Training Day: Mastering Reliability, Security, and Performance on Azure',
    languages: ['EN-US','FR-CA','EN-GB'],
    dayFormats: ['2 Day'],
    launchDate: '30th December',
    subjectLine: 'Thanks for joining Mastering Reliability, Security, and Performance on Azure',
    friendlyName: 'Microsoft Azure Virtual Training Day Mastering Reliability Security and Performance on Azure'
  },

  // ---------- Digital Simulive & PRC variants ----------
  {
    scope: 'FY25',
    eventSubType: 'Microsoft Azure Virtual Training Day: Migrate Linux and PostgreSQL to Azure (Digital Simulive)',
    languages: ['EN-US','EN-GB','FR-CA','JA-JP','FR-FR','PT-BR','ZH-CN','ZH-CN (PRC)','ES-XL','ES-ES'],
    dayFormats: ['1 Day'],
    launchDate: "10th January '25",
    subjectLine: 'Thanks for joining Migrate Linux and PostgreSQL to Azure',
    friendlyName: 'Microsoft Azure Virtual Training Day Migrate Linux and PostgreSQL to Azure'
  },

  {
    scope: 'FY25',
    eventSubType: 'Microsoft Security Virtual Training Day: Defend Against Threats with Extended Detection and Response - PRC',
    languages: ['ZH-CN'],
    dayFormats: ['2 Day'],
    launchDate: "10th January '25",
    subjectLine: 'Not required',
    friendlyName: 'Microsoft Security Virtual Training Day Defend Against Threats with Extended Detection and Response'
  },

  {
    scope: 'FY25',
    eventSubType: 'Microsoft Security Virtual Training Day: Implement Data Security with Microsoft Purview - PRC (Digital Simulive)',
    languages: ['ZH-CN'],
    dayFormats: ['2 Day'],
    launchDate: "17th January '25",
    subjectLine: 'Not required',
    friendlyName: 'Microsoft Security Virtual Training Day Implement Data Security with Microsoft Purview'
  },

  {
    scope: 'FY25',
    eventSubType: 'Microsoft Azure Virtual Training Day: Fundamentals - PRC (Digital Simulive)',
    languages: ['ZH-CN'],
    dayFormats: ['2 Day'],
    launchDate: '31st January',
    subjectLine: 'Not required',
    friendlyName: 'Microsoft Azure Virtual Training Day Fundamentals'
  },

  {
    scope: 'FY25',
    eventSubType: 'Microsoft Azure Virtual Training Day: Develop Your Own Custom Copilots with Azure AI - PRC (Digital Simulive)',
    languages: ['ZH-CN'],
    dayFormats: ['2 Day'],
    launchDate: '31st January',
    subjectLine: 'Not required',
    friendlyName: 'Microsoft Azure Virtual Training Day Develop Your Own Custom Copilots with Azure AI'
  },

  {
    scope: 'FY25',
    eventSubType: 'Microsoft Azure Virtual Training Day: Data Fundamentals - PRC',
    languages: ['ZH-CN'],
    dayFormats: ['2 Day'],
    launchDate: '7th Feb',
    subjectLine: 'Not required',
    friendlyName: 'Microsoft Azure Virtual Training Day Data Fundamentals'
  },

  {
    scope: 'FY25',
    eventSubType: 'Microsoft Security Virtual Training Day: Security, Compliance, and Identity Fundamentals - PRC',
    languages: ['ZH-CN'],
    dayFormats: ['2 Day'],
    launchDate: '7th Feb',
    subjectLine: 'Not required',
    friendlyName: 'Microsoft Security Virtual Training Day Security Compliance and Identity Fundamentals'
  },

  // ---------- February Digital Simulive ----------
  {
    scope: 'FY25',
    eventSubType: 'Microsoft Azure Virtual Training Day: Migrate and Modernize SAP on the Microsoft Cloud (Digital Simulive)',
    languages: ['EN-US','EN-GB','FR-CA'],
    dayFormats: ['1 Day'],
    launchDate: '14th Feb',
    subjectLine: 'Thanks for joining Migrate and Modernize SAP on the Microsoft Cloud',
    friendlyName: 'Microsoft Azure Virtual Training Day Migrate and Modernize SAP on the Microsoft Cloud'
  },

  {
    scope: 'FY25',
    eventSubType: 'Microsoft Azure Virtual Training Day: Build an AI App with Azure using RAG (Digital Simulive)',
    languages: ['EN-US','EN-GB','FR-CA'],
    dayFormats: ['1 Day'],
    launchDate: '14th Feb',
    subjectLine: 'Thanks for joining Build an AI App with Azure Using RAG',
    friendlyName: 'Microsoft Azure Virtual Training Day Build an AI App with Azure using RAG'
  },

  // ---------- Dynamics, Intune (March), ERP ----------
  {
    scope: 'FY25',
    eventSubType: 'Microsoft Dynamics 365 Virtual Training Day: Fundamentals (CRM) (Digital Simulive)',
    languages: ['EN-US','EN-GB','FR-CA'],
    dayFormats: ['2 Day'],
    launchDate: '—', // EN-US launch date not explicitly stated beyond "EN-US"
    subjectLine: 'Thanks for joining Dynamics 365 Fundamentals (CRM)',
    friendlyName: 'Microsoft Dynamics 365 Virtual Training Day Fundamentals CRM'
  },

  {
    scope: 'FY25',
    eventSubType: 'Microsoft 365 Virtual Training Day: Manage Windows Endpoints with Microsoft Intune',
    languages: ['EN-US','EN-GB','FR-CA'],
    dayFormats: ['2 Day'],
    launchDate: '14th March',
    subjectLine: 'Thanks for joining Manage Windows Endpoints with Microsoft Intune',
    friendlyName: 'Microsoft 365 Virtual Training Day Manage Windows Endpoints with Microsoft Intune'
  },

  {
    scope: 'FY25',
    eventSubType: 'Microsoft Dynamics 365 Virtual Training Day: Fundamentals (ERP)',
    languages: ['EN-US','EN-GB','FR-CA'],
    dayFormats: ['2 Day'],
    launchDate: '14th March',
    subjectLine: 'Thanks for joining Dynamics 365 Fundamentals (ERP)',
    friendlyName: 'Microsoft Dynamics 365 Virtual Training Day Fundamentals ERP'
  },

  {
    scope: 'FY25',
    eventSubType: 'Microsoft Dynamics 365 Virtual Training Day: Modernize Service',
    languages: ['EN-US','EN-GB','FR-CA'],
    dayFormats: ['1 Day'],
    launchDate: '21st March',
    subjectLine: 'Thanks for joining Modernize Service',
    friendlyName: 'Microsoft Dynamics 365 Virtual Training Day Modernize Service'
  },

  // ---------- Defender for Cloud (July) ----------
  {
    scope: 'FY25',
    eventSubType: 'Microsoft Security Virtual Training Day: Strengthen Cloud Security with Microsoft Defender for Cloud',
    languages: ['EN-US'],
    dayFormats: ['2 Day'],
    launchDate: '2nd July',
    subjectLine: 'Thanks for joining Strengthen Cloud Security with Microsoft Defender for Cloud',
    friendlyName: 'Microsoft Security Virtual Training Day Strengthen Cloud Security with Microsoft Defender for Cloud'
  },

        // FY26 — English primary language only
{ scope:'FY26', eventSubType:'Microsoft Virtual Training Day: Develop Generative AI Apps with Azure AI Foundry', languages:['EN-US'], dayFormats:['2 Day'], launchDate:'3rd October', subjectLine:'Thanks for joining Develop Generative AI Apps with Azure AI Foundry', friendlyName:'Microsoft Virtual Training Day: Develop Generative AI Apps with Azure AI Foundry' },
{ scope:'FY26', eventSubType:'Microsoft Virtual Training Day: Build Agentic AI Solutions with Azure AI Foundry', languages:['EN-US'], dayFormats:['1 Day'], launchDate:'3rd October', subjectLine:'Thanks for joining Build Agentic AI Solutions with Azure AI Foundry', friendlyName:'Microsoft Virtual Training Day: Build Agentic AI Solutions with Azure AI Foundry' },
{ scope:'FY26', eventSubType:'Microsoft Virtual Training Day: Secure and Administer Microsoft 365 Copilot and Agents', languages:['EN-US'], dayFormats:['1 Day'], launchDate:'3rd October', subjectLine:'Thanks for joining Secure and Administer Microsoft 365 Copilot and Agents', friendlyName:'Microsoft Virtual Training Day: Secure and Administer Microsoft 365 Copilot and Agents' },
{ scope:'FY26', eventSubType:'Microsoft Virtual Training Day: Transform your Everyday Business Processes with Agents', languages:['EN-US'], dayFormats:['1 Day'], launchDate:'3rd October', subjectLine:'Thanks for joining Transform your Everyday Business Processes with Agents', friendlyName:'Microsoft Virtual Training Day: Transform your Everyday Business Processes with Agents' },
{ scope:'FY26', eventSubType:'Microsoft Virtual Training Day: Create agents in Microsoft Copilot Studio', languages:['EN-US'], dayFormats:['1 Day'], launchDate:'31st October', subjectLine:'Thanks for joining Create agents in Microsoft Copilot Studio', friendlyName:'Microsoft Virtual Training Day: Create agents in Microsoft Copilot Studio' },
{ scope:'FY26', eventSubType:'Microsoft Virtual Training Day: Introduction to Microsoft Security', languages:['EN-US'], dayFormats:['1 Day'], launchDate:'3rd October', subjectLine:'Thanks for joining Introduction to Microsoft Security', friendlyName:'Microsoft Virtual Training Day: Introduction to Microsoft Security' },
{ scope:'FY26', eventSubType:'Microsoft Virtual Training Day: Predict and Defend Against Cybersecurity Threats', languages:['EN-US'], dayFormats:['1 Day'], launchDate:'10th October', subjectLine:'Thanks for joining Predict and Defend Against Cybersecurity Threats', friendlyName:'Microsoft Virtual Training Day: Predict and Defend Against Cybersecurity Threats' },
{ scope:'FY26', eventSubType:'Microsoft Virtual Training Day: Introduction to Microsoft Power Platform', languages:['EN-US'], dayFormats:['2 Day'], launchDate:'15th November', subjectLine:'Thanks for joining Introduction to Microsoft Power Platform', friendlyName:'Microsoft Virtual Training Day: Introduction to Microsoft Power Platform' },
      ];

      function populateEvents(){
        mvtdEvent.innerHTML='';
        const placeholder=document.createElement('option');
        placeholder.value=''; placeholder.textContent='Select...'; placeholder.disabled=true; placeholder.selected=true;
        mvtdEvent.appendChild(placeholder);

        const g25=document.createElement('optgroup'); g25.label='Scope as of today for FY25 MVTD';
        const g26=document.createElement('optgroup'); g26.label='Scope as of today for FY26 MVTD (Primary language: English)';

        const seen=new Set();
        MVTD_DATA.forEach(item=>{
          const key=`${item.scope}|${item.eventSubType}`; if(seen.has(key)) return; seen.add(key);
          const opt=document.createElement('option'); opt.value=item.eventSubType; opt.textContent=item.eventSubType; opt.dataset.scope=item.scope;
          (item.scope==='FY25'?g25:g26).appendChild(opt);
        });
        mvtdEvent.appendChild(g25); mvtdEvent.appendChild(g26);
      }

      function onEventChange(){
        const ev=mvtdEvent.value;
        const scope=mvtdEvent.selectedOptions[0]?.dataset.scope || '';
        const entry=MVTD_DATA.find(r=>r.eventSubType===ev && r.scope===scope);
        mvtdLang.innerHTML=''; mvtdDay.innerHTML='';
        if(!entry) return;
        entry.languages.forEach(code=>{const opt=document.createElement('option'); opt.value=code; opt.textContent=code; mvtdLang.appendChild(opt);});
        entry.dayFormats.forEach(df=>{const opt=document.createElement('option'); opt.value=df; opt.textContent=df; mvtdDay.appendChild(opt);});
      }

      function onSubmit(){
        const ev=mvtdEvent.value; const scope=mvtdEvent.selectedOptions[0]?.dataset.scope || '';
        const lang=mvtdLang.value; const day=mvtdDay.value;
        if(!ev || !lang || !day){announce('Please select Event, Language, and Day Format');return;}
        const match=MVTD_DATA.find(i=>i.eventSubType===ev && i.scope===scope && i.languages.includes(lang) && i.dayFormats.includes(day));
        if(match){
          mvtdScopeOut.textContent=match.scope;
          mvtdLaunchOut.textContent=match.launchDate||'—';
          mvtdSubjectOut.textContent=match.subjectLine||'';
          mvtdFriendlyOut.textContent=match.friendlyName||'';
          mvtdResult.style.display='block';
        }else{
          mvtdResult.style.display='none';
          announce('No match found. Check selections.');
        }
      }

      function onReset(){
        populateEvents();
        mvtdLang.innerHTML=''; mvtdDay.innerHTML='';
        mvtdResult.style.display='none';
      }

      mvtdBtn.addEventListener('click',()=>{const hidden=mvtdForm.style.display==='none'||mvtdForm.style.display===''; mvtdForm.style.display=hidden?'block':'none'; mvtdForm.setAttribute('aria-hidden', String(!hidden)); mvtdBtn.setAttribute('aria-expanded', String(hidden));});
      mvtdEvent.addEventListener('change', onEventChange);
      mvtdSubmit.addEventListener('click', onSubmit);
      mvtdReset.addEventListener('click', onReset);
      mvtdCopySubject.addEventListener('click', ()=>copyText(mvtdSubjectOut.textContent));
      mvtdCopyFriendly.addEventListener('click', ()=>copyText(mvtdFriendlyOut.textContent));

      populateEvents();
    })();
  </script>
</body>
</html>


